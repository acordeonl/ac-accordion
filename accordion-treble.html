<imports >
    <link rel="import" href="/bower_components/polymer/polymer.html">
    <link rel="import" href="/bower_components/ac-view/ac-led-group-behavior.html">
    <link rel="import" href="/bower_components/ac-view/view-audio.html">
    <link rel="import" href="/bower_components/local-dom/local-dom.html">
    <link rel="import" href="./accordion-button.html">
</imports>
<!--

Shows drop down menu (works on chrome)

### Usage
The list displayed in the drop down menu can be set as an attribute.

    <drop-menu list-items='["first" ,"second"]'></drop-menu>

For an overlayed drop menu:

    <drop-menu overlay-menu list-items='["first" ,"second"]'></drop-menu>

### Styling
 Custom property | Description | Default
----------------|-------------|----------
`--item-background-color` | List item backround color | `#f1ecef`
`--item-color` | List item color used for fonts | `#302f31`
`--button-close-color` | Icon button hover color | `4775D1`
`--button-background-color` | Drop menu's background color | `white`
`--button-close-color` | Icon button hover color | `4775D1`
`--icon-button` | Mixin applied the icon button | `{}`

@demo demo/drop-menu-demo.html
-->
<dom-module id="accordion-treble">
    <template>
        <style>
            :host {}
            local-dom {
                height: 100vh;
                width: 100%;
                @apply(--layout-center);
                @apply(--layout-justified);
                @apply(--layout-horizontal);
            }
            .col1 {
                height: 82vh;
                margin: 0;
                padding: 0;
                /*@apply(--layout-vertical);*/
                @apply(--layout-justified);
            }
            .col2 {
                height: 92vh;
                padding: 0;
                /*margin-left: -0.3vh;
                margin-right: -0.3vh;*/
                /*@apply(--layout-vertical);*/
                @apply(--layout-justified);
            }
            [mobile] .col2 {
                padding: 0;
            }
            [tablet] .col2 {
                padding: 0;
            }
            .vertical {
                @apply(--layout-vertical);
            }
            .reversedVertical {
                @apply(--layout-vertical-reverse);
            }
            .reversedHorizontal {
                @apply(--layout-horizontal-reverse);
            }
            .horizontal {
                @apply(--layout-horizontal);
            }
        </style>
        <!-- local DOM -->
        <view-audio
            id="trebleAudio"
            channel='0'
            total-notes='62'
            default-audio-url='/data/accordion_synth/treble'>
        </view-audio>
        <local-dom class$="{{_computeRotation(rotation)}}" mobile="{{mobile}}" tablet="{{tablet}}" laptop="{{laptop}}">
            <div class$="col1 {{_computeColRotation(rotation)}}">
                <accordion-button acLed ac-id='21' channel='0' ></accordion-button>
                <accordion-button acLed ac-id='22' channel='0' ></accordion-button>
                <accordion-button acLed ac-id='23' channel='0' ></accordion-button>
                <accordion-button acLed ac-id='24' channel='0' ></accordion-button>
                <accordion-button acLed ac-id='25' channel='0' ></accordion-button>
                <accordion-button acLed ac-id='26' channel='0' ></accordion-button>
                <accordion-button acLed ac-id='27' channel='0' ></accordion-button>
                <accordion-button acLed ac-id='28' channel='0' ></accordion-button>
                <accordion-button acLed ac-id='29' channel='0' ></accordion-button>
                <accordion-button acLed ac-id='30' channel='0' ></accordion-button>
            </div>
            <div class$="col2 {{_computeColRotation(rotation)}}">
                <accordion-button acLed ac-id='10' channel='0' ></accordion-button>
                <accordion-button acLed ac-id='11' channel='0' ></accordion-button>
                <accordion-button acLed ac-id='12' channel='0' ></accordion-button>
                <accordion-button acLed ac-id='13' channel='0' ></accordion-button>
                <accordion-button acLed ac-id='14' channel='0' ></accordion-button>
                <accordion-button acLed ac-id='15' channel='0' ></accordion-button>
                <accordion-button acLed ac-id='16' channel='0' ></accordion-button>
                <accordion-button acLed ac-id='17' channel='0' ></accordion-button>
                <accordion-button acLed ac-id='18' channel='0' ></accordion-button>
                <accordion-button acLed ac-id='19' channel='0' ></accordion-button>
                <accordion-button acLed ac-id='20' channel='0' ></accordion-button>
            </div>
            <div class$="col1 {{_computeColRotation(rotation)}}">
                <accordion-button acLed ac-id='0' channel='0' ></accordion-button>
                <accordion-button acLed ac-id='1' channel='0' ></accordion-button>
                <accordion-button acLed ac-id='2' channel='0' ></accordion-button>
                <accordion-button acLed ac-id='3' channel='0' ></accordion-button>
                <accordion-button acLed ac-id='4' channel='0' ></accordion-button>
                <accordion-button acLed ac-id='5' channel='0' ></accordion-button>
                <accordion-button acLed ac-id='6' channel='0' ></accordion-button>
                <accordion-button acLed ac-id='7' channel='0' ></accordion-button>
                <accordion-button acLed ac-id='8' channel='0' ></accordion-button>
                <accordion-button acLed ac-id='9' channel='0' ></accordion-button>
            </div>
        </local-dom>
    </template>
    <script>
        Polymer({
            is: "accordion-treble", observers: ['_swap(showingTreble)'],
            behaviors: [acLedGroupBehavior],
            listeners:{
                'click':'_test'
            },
            properties: {
                cnt:{
                    type:Number,
                    value:0
                }
            },
        /* ------------------- acLed Action ------------------- */
            // override
            _mapMIDIEventToAcLedId: function(channel,midiNote){
                return Math.floor((midiNote - 24) / 2) ;
            },
            // override
            _mapMIDIEventToAcLedState: function(channel,midiNote){
                return ((midiNote - 24) % 2) + 1;
            },
        /* ------------------- Chords ------------------- */
            _displayChord: function(chord){
                console.log('will display ', chord , 'in treble');
            },
            // TODO
            _test: function(){
                if (this.cnt === 0) {
                    this._playChord(0,[28,30,32])
                }
                if (this.cnt === 1) {
                    this._stopChord() ;
                }
                this.cnt ++ ;
                this.cnt %= 2 ;
            },
        /* ------------------- GUI ------------------- */
            _computeRotation: function(rotation){
                if( rotation )
                    return "reversedHorizontal" ;
                return "horizontal" ;
            },
            _computeColRotation: function(rotation){
                if( rotation )
                    return "reversedVertical" ;
                return "vertical" ;
            },
            _swap: function (showingTreble) {
                if (showingTreble) {
                    this.playAnimation('entry');
                }
            },
        /* ------------------- Setup ------------------- */
            ready: function () {
            /* ------------------- MIDI note mapping ------------------- */
                this._mapMIDIEventToNote(0,24,75);
                this._mapMIDIEventToNote(0,25,73);
                this._mapMIDIEventToNote(0,26,60);
                this._mapMIDIEventToNote(0,27,64);
                this._mapMIDIEventToNote(0,28,65);
                this._mapMIDIEventToNote(0,29,67);
                this._mapMIDIEventToNote(0,30,69);
                this._mapMIDIEventToNote(0,31,70);
                this._mapMIDIEventToNote(0,32,72);
                this._mapMIDIEventToNote(0,33,74);
                this._mapMIDIEventToNote(0,34,77);
                this._mapMIDIEventToNote(0,35,76);
                this._mapMIDIEventToNote(0,36,81);
                this._mapMIDIEventToNote(0,37,79);
                this._mapMIDIEventToNote(0,38,84);
                this._mapMIDIEventToNote(0,39,82);
                this._mapMIDIEventToNote(0,40,89);
                this._mapMIDIEventToNote(0,41,86);
                this._mapMIDIEventToNote(0,42,93);
                this._mapMIDIEventToNote(0,43,88);
                this._mapMIDIEventToNote(0,44,66);
                this._mapMIDIEventToNote(0,45,68);
                this._mapMIDIEventToNote(0,46,55);
                this._mapMIDIEventToNote(0,47,59);
                this._mapMIDIEventToNote(0,48,60);
                this._mapMIDIEventToNote(0,49,62);
                this._mapMIDIEventToNote(0,50,64);
                this._mapMIDIEventToNote(0,51,65);
                this._mapMIDIEventToNote(0,52,67);
                this._mapMIDIEventToNote(0,53,69);
                this._mapMIDIEventToNote(0,54,72);
                this._mapMIDIEventToNote(0,55,71);
                this._mapMIDIEventToNote(0,56,76);
                this._mapMIDIEventToNote(0,57,74);
                this._mapMIDIEventToNote(0,58,79);
                this._mapMIDIEventToNote(0,59,77);
                this._mapMIDIEventToNote(0,60,84);
                this._mapMIDIEventToNote(0,61,81);
                this._mapMIDIEventToNote(0,62,88);
                this._mapMIDIEventToNote(0,63,83);
                this._mapMIDIEventToNote(0,64,91);
                this._mapMIDIEventToNote(0,65,86);
                this._mapMIDIEventToNote(0,66,61);
                this._mapMIDIEventToNote(0,67,63);
                this._mapMIDIEventToNote(0,68,55);
                this._mapMIDIEventToNote(0,69,57);
                this._mapMIDIEventToNote(0,70,59);
                this._mapMIDIEventToNote(0,71,60);
                this._mapMIDIEventToNote(0,72,62);
                this._mapMIDIEventToNote(0,73,64);
                this._mapMIDIEventToNote(0,74,67);
                this._mapMIDIEventToNote(0,75,66);
                this._mapMIDIEventToNote(0,76,71);
                this._mapMIDIEventToNote(0,77,69);
                this._mapMIDIEventToNote(0,78,74);
                this._mapMIDIEventToNote(0,79,72);
                this._mapMIDIEventToNote(0,80,79);
                this._mapMIDIEventToNote(0,81,76);
                this._mapMIDIEventToNote(0,82,83);
                this._mapMIDIEventToNote(0,83,78);
                this._mapMIDIEventToNote(0,84,86);
                this._mapMIDIEventToNote(0,85,81);

            }
        });
    </script>
</dom-module>
